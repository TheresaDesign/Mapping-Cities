<!DOCTYPE html>
<html>
<head>
    <title>Mietpreise und Campus Ort</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        body { margin:0; padding:0; }
        #map { 
            height: 600px;
            width: 600px;
            margin: auto;
            background-color: white; 
        }
        br {
            color: blue;
        }

        /* Style for the information control */
        .info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: rgb(45, 3, 72); background: rgba(255, 255, 255, 0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; }
        .info h4 { margin: 0 0 5px; color: #777; }

        /* Style for the legend control */
        .legend { line-height: 18px; color: #555; }
        .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7; }
    </style>
</head>
<body>
    <!-- Div element where the map will be displayed -->
    <div id="map"></div>

    <!-- Include Leaflet library -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <!-- Include the GeoJSON data file (you need to replace this with your own data file) -->
    <script src="berlinMietpreise-Campus.js"></script>

    <script>
        // Initialize the map and set its view to a chosen geographical point and zoom level
        var map = L.map('map').setView([52.5, 13.45], 10);

        // Add a tile layer (the map tiles) from OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 12,
            opacity: 0,
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Function to determine the color based on population density
        function getColor(d) {
            return d > 6.9 ? '#DD54B6' :
                   d > 6.6  ? '#A75EE1' :
                   d > 6.3  ? '#6F54DD' :
                   d > 6.0  ? '#436BB6' :
                   d > 5.7  ? '#6699CC' :
                   d > 5.4  ? '#A8C0F0' :
                              '#EFF4FF';
        }

        // Function to set the style for each feature (district)
        function style(feature) {
            return {
                fillColor: getColor(feature.properties.miete),
                weight: 2,
                opacity: 1,
                color: 'white',
                dashArray: '3',
                fillOpacity: 0.7
            };
        }

        // Marker für Campus
        var redIcon = L.icon({
            iconSize: [38, 95],
            iconAnchor: [22, 94],
            popupAnchor: [-3, -76]
        });

        var marker1 = L.marker([52.5166,13.3925], {}).addTo(map);
        marker1.bindPopup("<h4>Humboltuniversität</h4><br>Hauptgebäude");
        marker1.on('mouseover', function (e) {
            this.openPopup();
        });
        marker1.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker2 = L.marker([52.4373,13.5390], {}).addTo(map);
        marker2.bindPopup("<h4>Humboltuniversität</h4><br>Campus Adlerhof");
        marker2.on('mouseover', function (e) {
            this.openPopup();
        });
        marker2.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker3 = L.marker([52.54574,13.3239], {}).addTo(map);
        marker3.bindPopup("<h4>Freie Universität Berlin</h4><br>Hauptcampus (Dahlem)");
        marker3.on('mouseover', function (e) {
            this.openPopup();
        });
        marker3.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker4 = L.marker([52.4372,13.3239], {}).addTo(map);
        marker4.bindPopup("<h4>Freie Universität Berlin</h4><br>Campus Lankwitz");
        marker4.on('mouseover', function (e) {
            this.openPopup();
        });
        marker4.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker5 = L.marker([ 52.4167,13.2478], {}).addTo(map);
        marker5.bindPopup("<h4>Freie Universität Berlin</h4><br>Campus Düppel");
        marker5.on('mouseover', function (e) {
            this.openPopup();
        });
        marker5.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker6 = L.marker([52.5113,13.3262], {}).addTo(map);
        marker6.bindPopup("<h4>Technische Universität Berlin</h4><br>Hauptcampus Charlottenburg");
        marker6.on('mouseover', function (e) {
            this.openPopup();
        });
        marker6.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker7 = L.marker([52.5071, 13.3296], {}).addTo(map);
        marker7.bindPopup("<h4>Universität der Künste Berlin</h4><br>Hauptstandort Charlottenburg");
        marker7.on('mouseover', function (e) {
            this.openPopup();
        });
        marker7.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker8 = L.marker([52.5457, 13.3616], {}).addTo(map);
        marker8.bindPopup("<h4>Universität der Künste</h4><br>Standort Berlin-Wedding");
        marker8.on('mouseover', function (e) {
            this.openPopup();
        });
        marker8.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker9 = L.marker([52.5232, 13.3929], {}).addTo(map);
        marker9.bindPopup("<h4>Charité – Universitätsmedizin Berlin</h4><br>Campus Mitte (Charitéplatz)");
        marker9.on('mouseover', function (e) {
            this.openPopup();
        });
        marker9.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker10 = L.marker([52.5267, 13.3531], {}).addTo(map);
        marker10.bindPopup("<h4>Charité – Universitätsmedizin Berlin</h4><br>Campus Virchow-Klinikum (Augustenburger Platz)");
        marker10.on('mouseover', function (e) {
            this.openPopup();
        });
        marker10.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker11 = L.marker([52.4559, 13.2816], {}).addTo(map);
        marker11.bindPopup("<h4>Charité – Universitätsmedizin Berlin</h4><br>Campus Benjamin Franklin (Hindenburgdamm)");
        marker11.on('mouseover', function (e) {
            this.openPopup();
        });
        marker11.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker12 = L.marker([52.4949, 13.5251], {}).addTo(map);
        marker12.bindPopup("<h4>Hochschule für Technik und Wirtschaft Berlin</h4><br>Campus Treskowallee");
        marker12.on('mouseover', function (e) {
            this.openPopup();
        });
        marker12.on('mouseout', function (e) {
            this.closePopup();
        });

        var marker13 = L.marker([52.4576,13.5206], {}).addTo(map);
        marker13.bindPopup("<h4>Hochschule für Technik und Wirtschaft Berlin</h4><br>Campus Wilhelminenhof");
        marker13.on('mouseover', function (e) {
            this.openPopup();
        });
        marker13.on('mouseout', function (e) {
            this.closePopup();
        });

        // Function to highlight a feature (state) when hovered
        function highlightFeature(e) {
            var layer = e.target;

            layer.setStyle({
                weight: 5,
                color: '#1B3669',
                dashArray: '',
                fillOpacity: 0.7
            });

            layer.bringToFront();
            info.update(layer.feature.properties);
        }

        // Function to reset the highlight when the mouse leaves the feature (state)
        function resetHighlight(e) {
            geojson.resetStyle(e.target);
            info.update();
        }

        // Function to zoom to a feature (state) when clicked
        function zoomToFeature(e) {
            map.fitBounds(e.target.getBounds());
        }

        // Function to attach the above event listeners to each feature (state)
        function onEachFeature(feature, layer) {
            layer.on({
                mouseover: highlightFeature,
                mouseout: resetHighlight,
                click: zoomToFeature
            });
        }

        // Create a GeoJSON layer and add it to the map
        var geojson = L.geoJson(statesData, {
            style: style,
            onEachFeature: onEachFeature
        }).addTo(map);

        // Custom control to display information about the state being hovered
        var info = L.control();

        info.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info'); // Create a div with a class "info"
            this.update();
            return this._div;
        };

        // Method to update the control based on feature properties passed
        info.update = function (props) {
            this._div.innerHTML = '<h4>Median rent per district</h4>' +  (props ?
                '<b>' + props.name + '</b><br />' + props.miete + ' € / m<sup>2</sup>' 
                : 'Hover over a district');
        };

        info.addTo(map);

        // Custom legend control
        var legend = L.control({position: 'bottomright'});

        legend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'legend'),
                grades = [0, 5.4, 5.7, 6.0, 6.3, 6.6, 6.9],
                labels = [];

            // Loop through our density intervals and generate a label with a colored square for each interval
            for (var i = 0; i < grades.length; i++) {
                div.innerHTML +=
                    '<i style="background:' + getColor(grades[i] + 0.1) + '"></i> ' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
            }

            return div;
        };

        legend.addTo(map);
    </script>
</body>
</html>
